<template>
    <el-dialog
      v-model="dialogVisible"
      title="âœ¨ æ›´æ–°å…¬å‘Š âœ¨"
      width="50%"
      :close-on-click-modal="false"
      :show-close="false"
      class="announcement-dialog"
    >
      <div class="announcement-content">
        <h3>äº²çˆ±çš„åŒå­¦ä»¬ï¼š</h3>
        <p>æ­¤ç½‘ç«™äº4æœˆ10æ—¥æ™š12ç‚¹å®Œæˆæ›´æ–°ï¼Œä»¥ä¸‹æ˜¯æœ¬æ¬¡æ›´æ–°å†…å®¹ï¼š</p>
        <ul>
          <li>ğŸŒŸ çº¿ä¸Šæ‰“å¡çš„æœ€å¤§ç­¾é€€æ—¶é—´å»¶é•¿è‡³ <strong>6å°æ—¶</strong>ï¼Œè¦è®°å¾—å¥½å¥½ç­¾é€€å“¦ï¼</li>
          <li>ğŸ”§ ä¿®æ”¹äº†ç­¾åˆ°ç³»ç»Ÿçš„éƒ¨åˆ†é€»è¾‘ï¼Œç°åœ¨é‡æ–°ç™»å½•ä¼šåŒæ­¥ç­¾åˆ°ä¸­çš„æ—¶é—´ã€‚</li>
          <li>ğŸ‰ æ–°å¢äº†ç½‘ç«™çš„æ›´æ–°å…¬å‘Šï¼Œä¼šåœ¨æ¯æ¬¡ç½‘ç«™æ›´æ–°åçš„ç¬¬ä¸€æ¬¡ç™»å½•æ—¶æ˜¾ç¤ºã€‚</li>
        </ul>
        <p>å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·è”ç³»ä»¥ä¸‹é‚®ç®±ï¼š</p>
        <p>
          ğŸ“§ <a href="mailto:caozhx8@mail2.sysu.edu.cn">caozhx8@mail2.sysu.edu.cn</a> æˆ–
          <a href="mailto:wujj258@mail2.sysu.edu.cn">wujj258@mail2.sysu.edu.cn</a>
        </p>
      </div>
      <template #footer>
        <el-button type="primary" @click="closeDialog" class="confirm-button">æˆ‘çŸ¥é“äº†</el-button>
      </template>
    </el-dialog>
  </template>
  
  <script setup>
  import { ref, onMounted } from 'vue';
  
  const dialogVisible = ref(false);
  
  // å½“å‰å…¬å‘Šçš„å”¯ä¸€æ ‡è¯†
  const currentAnnouncementId = '20250410';
  
  // æ£€æŸ¥æ˜¯å¦éœ€è¦æ˜¾ç¤ºå…¬å‘Š
  const checkAndShowAnnouncement = () => {
    const storedAnnouncementId = localStorage.getItem('announcementId');
    const lastCheckedDate = localStorage.getItem('lastCheckedDate');
    const token = localStorage.getItem('token'); // æ£€æŸ¥æ˜¯å¦ç™»å½•
    if (
      storedAnnouncementId !== currentAnnouncementId &&
      String(lastCheckedDate) <= currentAnnouncementId &&
      token
    ) {
      dialogVisible.value = true;
      localStorage.setItem('announcementId', currentAnnouncementId);
    }
  };
  
  // å…³é—­å…¬å‘Šå¹¶è®°å½•å·²æŸ¥çœ‹
  const closeDialog = () => {
    dialogVisible.value = false;
  };
  
  // åœ¨ç»„ä»¶æŒ‚è½½æ—¶æ£€æŸ¥å…¬å‘Š
  onMounted(() => {
    checkAndShowAnnouncement();
  });
  </script>
  
  <style scoped>
  .announcement-dialog {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    background-color: #ffffff; /* æŸ”å’Œçš„èƒŒæ™¯è‰² */
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* æ·»åŠ é˜´å½±æ•ˆæœ */
    border: 5px solid transparent;
    background-clip: padding-box;
    position: relative;
  }
  
  .announcement-content {
    text-align: left;
    color: #333;
    padding: 20px;
    border-radius: 10px;
    background-color: #ffff; /* ä½¿ç”¨çº¯è‰²èƒŒæ™¯æ›¿ä»£æ¸å˜è‰² */
  }
  
  h3 {
    margin-bottom: 15px;
    color: #ff6f61; /* çªå‡ºçš„æ ‡é¢˜é¢œè‰² */
    font-weight: bold;
  }
  
  ul {
    margin: 15px 0;
    padding-left: 20px;
    color: #555;
  }
  
  ul li {
    margin-bottom: 10px;
    font-size: 16px;
  }
  
  a {
    color: #409eff;
    text-decoration: none;
    font-weight: bold;
  }
  
  a:hover {
    text-decoration: underline;
  }
  
  .confirm-button {
    background-color: #ff6f61;
    color: white;
    border: none;
    font-weight: bold;
  }
  
  .confirm-button:hover {
    background-color: #ff856e;
  }
  </style>